<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Touken</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script>
    window.ARTICLES = [{"id":"MinerU 的 Docker 部署与代码调用","title":"MinerU 的 Docker 部署与代码调用","description":"容器化部署 MinerU 的方案, 使用官方 API 调用","tags":["MinerU","Docker","VLM","OCR"],"updatedAt":"2026-01-20T18:50:32.000Z"}];
  </script>
</head>
<body>
  <nav>
    <div class="wrapper">
      <a href="index.html" class="brand">TOUKEN</a>
      <div class="nav-links">
        <a href="index.html" class="nav-link">BLOG</a>
      </div>
    </div>
  </nav>

  <main class="wrapper">
    <!-- Search Section -->
    <div class="search-box">
      <input type="text" id="searchInput" class="search-input" placeholder="Search...">
      <div id="tagCloud" class="tag-cloud">
        <button class="tag-btn" data-tag="MinerU">MinerU <span class="text-xs opacity-50 ml-1">1</span></button><button class="tag-btn" data-tag="Docker">Docker <span class="text-xs opacity-50 ml-1">1</span></button><button class="tag-btn" data-tag="VLM">VLM <span class="text-xs opacity-50 ml-1">1</span></button><button class="tag-btn" data-tag="OCR">OCR <span class="text-xs opacity-50 ml-1">1</span></button>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats">
      <span>ARTICLES</span>
      <span id="resultCount">1 Total</span>
    </div>

    <!-- List -->
    <div id="articleList">
      
    </div>
  </main>

  <footer>
    <div class="wrapper">
      &copy; 2026 Touken. Minimalist.
    </div>
  </footer>

  <script>
(function() {
  'use strict';

  const articles = window.ARTICLES || [];

  let selectedTags = new Set();
  let searchQuery = '';
  let elements;

  function init() {
    elements = {
      searchInput: document.getElementById('searchInput'),
      tagCloud: document.getElementById('tagCloud'),
      articleList: document.getElementById('articleList'),
      resultCount: document.getElementById('resultCount'),
    };

    if (elements.searchInput) {
      elements.searchInput.addEventListener('input', (e) => {
        searchQuery = e.target.value.trim().toLowerCase();
        render();
      });
    }

    if (elements.tagCloud) {
      elements.tagCloud.addEventListener('click', (e) => {
        // Find the button element even if child is clicked
        const btn = e.target.closest('.tag-btn');
        if (btn) {
          toggleTag(btn.dataset.tag);
        }
      });
    }

    render();
  }

  function toggleTag(tag) {
    if (selectedTags.has(tag)) {
      selectedTags.delete(tag);
    } else {
      selectedTags.add(tag);
    }
    updateTagButtons();
    render();
  }

  function updateTagButtons() {
    document.querySelectorAll('.tag-btn').forEach((btn) => {
      const tag = btn.dataset.tag;
      if (selectedTags.has(tag)) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    });
  }

  function filterArticles(list) {
    if (selectedTags.size > 0) {
      list = list.filter((a) =>
        a.tags.some((tag) => selectedTags.has(tag))
      );
    }

    if (searchQuery) {
      list = list.filter((a) => {
        const title = a.title.toLowerCase();
        const description = (a.description || '').toLowerCase();
        return title.includes(searchQuery) || description.includes(searchQuery);
      });
    }

    return list;
  }

  function sortArticles(list) {
    return [...list].sort((a, b) => {
      return new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime();
    });
  }

  function formatDate(dateStr) {
    const date = new Date(dateStr);
    return date.toLocaleDateString('zh-CN', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
    }).replace(/\//g, '-');
  }

  function renderItem(article) {
    return `
      <a href="article/${article.id}.html" class="article-item">
        <div class="article-date">${formatDate(article.updatedAt)}</div>
        <h2 class="article-title">${article.title}</h2>
        ${article.description ? `<p class="text-[var(--fg-light)] mt-2 line-clamp-2">${article.description}</p>` : ''}
      </a>
    `;
  }

  function render() {
    let list = filterArticles(articles);
    list = sortArticles(list);

    const container = elements.articleList;
    if (list.length === 0) {
      container.innerHTML = '<div class="py-12 text-center text-[var(--fg-light)]">No articles found</div>';
      if (elements.resultCount) elements.resultCount.textContent = '0 Total';
      return;
    }

    container.innerHTML = list
      .map((article) => renderItem(article))
      .join('');
      
    if (elements.resultCount) {
      elements.resultCount.textContent = `${list.length} Total`;
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();

  </script>
</body>
</html>